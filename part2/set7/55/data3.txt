
UUIDGEN ?= uuidgen
## Most basic use:


  function) will be linked against the convenience library to become
keeping sources and headers in sync, so `make clean` should seldom have to be
[How variables get their values](https://www.gnu.org/software/make/manual/html_node/Values.html#Values)
    CXX_INTERNAL_HEADER_EXTENSION (defaults to: $(CXX_INTERNAL_HEADER_EXTENSION))

update precompiled headers.
E.g.:
    make parser/tokenizer.fc++
internal header will subsequently find and include it. The template for
exercise dirs. Make can generate examples, but you need to edit them.
# Using a $(shell find...) would also work, but depend on the find utility.
first_extension_found = $(patsubst .%,%,$(or $(firstword $(foreach X,$1,$(filter %.$X,$(suffix $(ALL_FILES))))),$(firstword $1)))
CURRENT_MAKEFILE = $(firstword $(MAKEFILE_LIST))
# Some use h
FLEXCXX_SCANNERSPEC_EXTENSION ?= $(call first_extension_found, fc++ fcpp fcxx flexc++ flexcpp flexcxx )
PCH ?= true
CONVLIB = $(notdir $(CURDIR))
DEPDIR ?= generated_deps
DETECTED_MAKEVERSION = $(shell $(MAKE) --version)
   $(if $(filter $(1),t true  True  TRUE  yes Yes YES YESS! on  On  ON  one  One  ONE  1),true,),\

USE_GENERATED_DEPENDENCIES := $(call boolalpha,$(DEP))
# Acts as 'dir', but may return the empty string instead of './'


# To detect a main() function in a source file.
CXX_NONPROG_OBJECTS := $(CXX_NONPROG_SOURCES:%.$(CXX_SOURCE_EXTENSION)=%.$(CXX_OBJECT_EXTENSION))
# From every internal header we can build a precompiled (internal) header.



%.C.o: %.C     ; $(RUN-CPPCOMPILE)

$(CXX_OBJECTS): METHOD = Compile    
$(CXX_PRECOMPILED_HEADERS): INPUTS = $(filter %.$(CXX_INTERNAL_HEADER_EXTENSION),$^)
EVER_GENERATED_FILES = $(filter $(addefix %.,$(GENERATED_EXTENSIONS)),$(ALL_FILES))
ECHO_ACTION = @echo "    [ $(METHOD)  $(or $(INPUTS),$^)\t$(ACTION)\t$(or $(TARGET),$@)\t]"
#    we need the prerequisites, i.e. $(CXX_NONPROG_OBJECTS)
	$(ECHO_ACTION)

	$(QUIET) $(CXX) $(CPPFLAGS) $(CXXFLAGS) -o $@ $< $(LDFLAGS)
mostlyclean:
%_tested: %

.DELETE_ON_ERROR:
	$(QUIET) printf '$(subst $(NEWLINE),\n,$(TEMPLATE))' >> "$(@)"
	@echo "Please edit it to replace the bogus information in there."

    $(ORDER_TXTS): %order.txt: clean
	@echo "Per project we prefer calling order."
# If we're in a set directory, and if asked explicitly, we can create a zip.
        # No metadata.txt found.
            $(info with the command:)
            $(error No metadata.txt found.)
            # This is good: metadata.txt found in current dir.
            $(info We have no idea how to handle this.)

    $(info (Please note that any 'generated_deps' is not the problem.))
    # Require 'all' to check that everything compiles.
    # Here's why we only create zips from the set dir.
    ordertxt_check: $(FILES_MENTIONED_IN_ORDER_TXTS)
endif
###  Below follow some templates that will create source and header files. ###

#%\:cxx_class: %\:cxx_header %\:cxx_internal_header
define CXX_HEADER_TEMPLATE
include-internal-headers-in-same-dir = $(foreach IHEADER,$(wildcard $(@D)/*.$(CXX_INTERNAL_HEADER_EXTENSION)),#include "$(notdir $(IHEADER))"\n)
# Ordinary source template

    SUCCESS = 0,
    {
int handle_exceptions(std::exception_ptr excp)
    {
    {
define FLEXCXX_SCANNERSPEC_TEMPLATE
//%%input-implementation = "sourcefile"
//%%skeleton-directory = "pathname"
endef
// %%baseclass-preinclude: specifying a header included by the baseclass
// %%class-header: defining the parser class header
//               VECT: std::vector<double>
# Metadata.txt template (but not by extension, so not in TEMPLATABLE_GOALS
define ORDER_TXT_TEMPLATE

# then only if they don't exist yet.
ifneq (,$(TEMPLATABLE_GOALS))
    %.$(BISONCXX_PARSERSPEC_EXTENSION): TEMPLATE = $(BISONCXX_PARSERSPEC_TEMPLATE)

    GOALS_THAT_NEED_DEPS := $(strip $(filter-out $(TARGETS_THAT_DONT_NEED_DEPS),$(MAKECMDGOALS)))
    undefine TARGETS_THAT_DONT_NEED_DEPS
    $(CXX_PCH_DEPS): CPPFLAGS += -E -fdirectives-only -MQ $(patsubst %.$(CXX_INTERNAL_HEADER_EXTENSION),%.$(CXX_PCH_EXTENSION),$<) -MM -MF $@
    # To create a .dep file from a source or internal header file.
    # flexc++ whenever the spec is newer.
	$(QUIET) $(FLEXCXX) $(FLEXCXXFLAGS) --target-directory=$(or $(*D),.) $< 
    $(BISONCXX_DEPS): $(call deps_of,%): %
    # before source deps?
    # So we remove the files first, then remove empty dirs only.
endif
$(DIR)../%: $(patsubst ./%,%,$(dir $(DIR:%/=%))%)

    $(CXX_PRECOMPILED_HEADERS): %.$(CXX_PCH_EXTENSION): %.$(CXX_INTERNAL_HEADER_EXTENSION)
    $(CXX_OBJECTS): $$(patsubst %.$(CXX_INTERNAL_HEADER_EXTENSION),%.$(CXX_PCH_EXTENSION),$$^)
